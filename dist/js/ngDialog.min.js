!function(e,t){"undefined"!=typeof module&&module.exports?(t("undefined"==typeof angular?require("angular"):angular),module.exports="ngDialog"):"function"==typeof define&&define.amd?define(["angular"],t):t(e.angular)}(this,function(e){"use strict";var t=e.module("ngDialog",[]),o=e.element,n="animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend",l="ngdialog-disabled-animation",a={empty:"<h1>模板不能为空！</h1>",only:"<h1>template和templateUrl只能配置一项！</h1>"},i={esc:27},s=!1,c={disableAnimation:!1,showClose:!0,closeByDocument:!0,closeByEsc:!0,closeByRouter:!0,preCloseCallback:!1,overlay:!0,className:"ngdialog-theme-default",bodyClassName:"ngdialog-open",width:null,height:null};t.provider("ngDialog",function(){this.defaults=c,this.setDefaults=function(t){e.extend(c,t)};var t=0,d=0,r={},g={},u=[];this.$get=["$rootScope","$document","$templateCache","$compile","$q","$http","$timeout","$window","$controller","$injector",function(m,f,p,h,y,D,C,v,w,b){var $=f.find("body"),E=f.find("html"),B={getViewportSize:function(){var e={};return window.innerWidth?(e.winW=window.innerWidth,e.winH=window.innerHeight):document.documentElement.offsetWidth===document.documentElement.clientWidth?(e.winW=document.documentElement.offsetWidth,e.winH=document.documentElement.offsetHeight):(e.winW=document.documentElement.clientWidth,e.winH=document.documentElement.clientHeight),e.docW=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth,document.documentElement.offsetWidth),e.docH=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight,document.documentElement.offsetHeight),e},contentMiddle:function(e){var t=e[0].querySelector(".ngdialog-content"),n=B.getComputedStyle(t),l=B.getViewportSize();o(t).css({position:"absolute",left:(l.winW-parseInt(n.width,10))/2+"px",top:(l.winH-parseInt(n.height,10))/2+"px"})},keydownHandler:function(e){e.keyCode===i.esc&&S.close("$escape")},performCloseDialog:function(e,t){var o=e.data("$ngDialogOptions"),l=e.attr("id"),a=g[l];if(a){if("undefined"!=typeof v.Hammer){var i=a.hammerTime;i.off("tap",function(t){B.closeDocumentHandler.call(e,t)}),i.destroy&&i.destroy(),delete a.hammerTime}else e.unbind("click");1===d&&$.unbind("keydown",B.keydownHandler),e.hasClass("ngdialog-closing")||(d-=1),m.$broadcast("ngDialog.closing",e,t),d=d<0?0:d,o.disableAnimation?(a.$destroy(),B.closeDialogElement(e,t)):(a.$destroy(),e.unbind(n).bind(n,function(){B.closeDialogElement(e,t)}).addClass("ngdialog-closing")),r[l]&&(r[l].resolve({id:l,value:t,$dialog:e,remainingDialogs:d}),delete r[l]),g[l]&&delete g[l],u.splice(u.indexOf(l),1),u.length||($.unbind("keydown",B.keydownHandler),s=!1)}},getComputedStyle:function(e){return window.getComputedStyle?window.getComputedStyle(e,null):e.currentStyle},closeDialogElement:function(e,t){var o=e.data("$ngDialogOptions");e.remove(),0===d&&(E.removeClass(o.bodyClassName),$.removeClass(o.bodyClassName)),m.$broadcast("ngDialog.closed",e,t)},closeDialog:function(t,o){var n=t.data("$ngDialogOptions"),l=n.preCloseCallback;if(l&&e.isFunction(l)){var a=l.call(t,o);if(e.isObject(a))a.closePromise?a.closePromise.then(function(){B.performCloseDialog(t,o)},function(){return!1}):a.then(function(){B.performCloseDialog(t,o)},function(){return!1});else{if(a===!1)return!1;B.performCloseDialog(t,o)}}else B.performCloseDialog(t,o)},detectUIRouter:function(){try{return e.module("ui.router"),!0}catch(e){return!1}},getRouterLocationEventName:function(){return B.detectUIRouter()?"$stateChangeStart":"$locationChangeStart"},closeDocumentHandler:function(e){var t=this.data("$ngDialogOptions"),n=!!t.closeByDocument&&o(e.target).hasClass("ngdialog-overlay"),l=o(e.target).hasClass("ngdialog-close");(n||l)&&S.close(this.attr("id"),l?"$closeButton":"$document")},getTemplateByUrl:function(t,o){return o.headers=o.headers||{},e.extend(o.headers,{Accept:"text/html"}),m.$broadcast("ngDialog.templateLoading",t),D.get(t,o).then(function(e){return m.$broadcast("ngDialog.templateLoaded",t),e.data||""})},getTemplate:function(t,o){return"interior"===o&&e.isString(t)?"<"===t.trim()[0]?t:this.getTemplateByUrl(t,{cache:p}):this.getTemplateByUrl(t,{cache:!1})},setDialogSize:function(t){var o=this.data("$ngDialogOptions"),n=this[0].querySelector(".ngdialog-content");t&&e.isNumber(o[t])?n.style[t]=o[t]+"px":n.style[t]=o[t]}},S={open:function(n){var i,f,p,D,v,S,k=e.copy(c),H="ngdialog"+ ++t;return u.push(H),n=n||{},k.data&&e.isObject(k.data)&&("undefined"==typeof n.data&&(n.data={}),n.data=e.merge(e.copy(k.data),n.data)),e.extend(k,n),r[H]=i=y.defer(),g[H]=f=e.isObject(k.scope)?k.scope.$new():m.$new(),p=e.extend({},k.resolve),e.forEach(p,function(t,o){p[o]=e.isString(t)?b.get(t):b.invoke(t,null,null,o)}),k.template||k.templateUrl||(k.template=a.empty,k.templateUrl=""),k.template&&k.templateUrl&&(k.template=a.only,k.templateUrl=""),v=k.template&&!k.templateUrl?"interior":"exterior",D=k.template||k.templateUrl,y.all({template:B.getTemplate(D,v),locals:y.all(p)}).then(function(t){var n=t.template,a="",i=t.locals;if(k.showClose&&(n+='<div class="ngdialog-close"></div>'),k.overlay&&(a+='<div class="ngdialog-overlay"></div>'),S=o('<div id="'+H+'" class="ngdialog"></div>'),S.html(a+'<div class="ngdialog-content">'+n+"</div>"),S.data("$ngDialogOptions",k),f.ngDialogId=H,k.data&&e.isObject(k.data)&&(f.ngDialogData=k.data,f.ngDialogData.ngDialogId=H),f.closeDialog=function(e){B.closeDialog(S,e)},k.className&&S.addClass(k.className),k.disableAnimation&&S.addClass(l),k.width&&B.setDialogSize.call(S,"width"),k.height&&B.setDialogSize.call(S,"height"),k.controller&&(e.isString(k.controller)||e.isArray(k.controller)||e.isFunction(k.controller))){var c=e.extend(i,{$scope:f,$element:S});w(k.controller,c,!0)()}if(s||($.bind("keydown",B.keydownHandler),s=!s),k.closeByRouter){var r=B.getRouterLocationEventName();m.$on(r,function(e){B.closeDialog(S)===!1&&e.preventDefault()})}S.bind("click",function(e){B.closeDocumentHandler.call(S,e)}),d+=1,C(function(){h(S)(f),E.addClass(k.bodyClassName),$.addClass(k.bodyClassName),$.append(S),B.contentMiddle(S),m.$broadcast("ngDialog.opened",S)})}),{id:H,closePromise:i.promise,close:function(e){B.closeDialog(S,e)}}},openConfirm:function(t){var n,l=y.defer(),a=e.copy(c);if(t=t||{},a.data&&e.isObject(a.data)&&("undefined"==typeof t.data&&(t.data={}),t.data=e.merge(e.copy(a.data),t.data)),e.extend(a,t),a.scope=m.$new(),a.scope.confirm=function(e){l.resolve(e);var t=o(document.getElementById(n.id));B.performCloseDialog(t,e)},n=S.open(a))return n.closePromise.then(function(e){return e?l.reject(e.value):l.reject()}),l.promise},isOpen:function(e){var t=o(document.getElementById(e));return t.length>0},close:function(e,t){var n=o(document.getElementById(e));if(n.length)B.closeDialog(n,t);else if("$escape"===e){var l=u[u.length-1];n=o(document.getElementById(l)),n.data("$ngDialogOptions").closeByEsc&&B.closeDialog(n,"$escape")}else S.closeAll(t);return S},closeAll:function(e){for(var t=document.querySelectorAll(".ngdialog"),n=t.length-1;n>=0;n--){var l=t[n];B.closeDialog(o(l),e)}},getOpenDialogs:function(){return u}};return S}]}),t.directive("ngDialog",["ngDialog",function(e){return{restrict:"A",scope:{ngDialogScope:"="},link:function(t,o,n){o.on("click",function(t){t.preventDefault(),e.open({template:n.ngDialog,className:n.ngDialogClass||c.className,controller:n.ngDialogController,disableAnimation:"false"!==n.ngDialogDisableAnimation,data:n.ngDialogData,showClose:"false"!==n.ngDialogShowClose&&("true"===n.ngDialogShowClose||c.showClose),closeByDocument:"false"!==n.ngDialogCloseByDocument&&("true"===n.ngDialogCloseByDocument||c.closeByDocument),closeByEsc:"false"!==n.ngDialogCloseByEsc&&("true"===n.ngDialogCloseByEsc||c.closeByEsc),overlay:"false"!==n.ngDialogOverlay&&("true"===n.ngDialogOverlay||c.overlay),preCloseCallback:n.ngDialogPreCloseCallback||c.preCloseCallback,bodyClassName:n.ngDialogBodyClass||c.bodyClassName})})}}}])});
//# sourceMappingURL=ngDialog.min.js.map
